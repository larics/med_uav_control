<launch>

    <arg name="rc_joy" default="false"/>
    <arg name="logitech_joy" default="true"/>
    <arg name="run_experiment" default="true"/>
    <arg name="record_experiment" default="true"/>
    <arg name="joy_rate" default="10"/>
    <arg name="user_id" default="0"/>
    <arg name="run" default="0"/>
    <arg name="participant" default="JohnDoe"/>
    <arg name="email" default="john.doe@gmail.com"/>

	<!-- Launch UAV -->
    <include file="$(find med_uav_description)/launch/bebop_empty.launch">
        <arg name="x" default="0.0"/>
        <arg name="y" default="-1.5"/>
        <arg name="yaw" default="0.0"/>
        <arg name="wind_force" value="0.0"/>
        <arg name="wind_start" default="0.0"/>
        <arg name="wind_duration" default="0.0"/>
        <arg name="wind_direction_x" default="0.0"/>
        <arg name="wind_direction_y" default="0.0"/>
        <arg name="wind_direction_z" default="0.0"/>
    </include>

    <!-- Include PIPE -->
    <include file="$(find larics_gazebo_worlds)/models/pipe/spawn_pipe.launch">
        <arg name="x" default="0.0"/>
        <arg name="y" default="0.0"/>
        <arg name="z" default="0.0"/>
        <arg name="pipe_name" default="pipe2"/>
    </include>

    <group ns="bebop">
        <node pkg="med_uav_control" type="height_ctl.py" name="height_ctl" output="screen"/>
        <node pkg="med_uav_control" type="attitude_ctl.py" name="attitude_ctl" output="screen"/>
    </group>
    
    <!-- Run normal joy node for normal joystick -->
    <group if="$(arg logitech_joy)">

        <node name="joy" pkg="joy" type="joy_node" output="screen">
            <param name="autorepeat_rate" value="$(arg joy_rate)"/>
        </node>

    </group>

    <!-- Record bag for experiment -->
    <node name="race_observer" pkg="med_uav_control" type="race.py" args="$(arg participant) $(arg email)" output="screen"></node>

    <!-- Run joy -->        
    <include file="$(find med_uav_control)/launch/bebop_joy_override.launch"/>

    <!-- Run fpv --> 
    <include file="$(find uav_ar_gui)/launch/uav_ar_gui.launch"/>

    
</launch>